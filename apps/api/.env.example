# Journal API Environment Configuration
# Copy this file to .env and fill in your values

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
DATABASE_URL=postgresql+asyncpg://journal:journal@localhost:5432/journal
DATABASE_URL_SYNC=postgresql://journal:journal@localhost:5432/journal

# =============================================================================
# REDIS CONFIGURATION  
# =============================================================================
JOURNAL_REDIS_URL=redis://localhost:6379/0

# =============================================================================
# JWT/AUTH CONFIGURATION
# =============================================================================
JWT_SECRET=your-super-secret-jwt-key-here
JWT_ISS=https://api.yourjournal.com
JWT_AUD=https://api.yourjournal.com

# Access token TTL (seconds) - default: 900 (15 minutes)
ACCESS_TOKEN_TTL=900

# Refresh token TTL (seconds) - default: 604800 (7 days)  
REFRESH_TOKEN_TTL=604800

# Enable cookie-based refresh tokens (true/false)
JOURNAL_AUTH_COOKIE_REFRESH=true

# Cookie domain for refresh tokens
JOURNAL_REFRESH_COOKIE_DOMAIN=yourjournal.com

# =============================================================================
# INFISICAL SECRET MANAGEMENT (UNIVERSAL AUTH - RECOMMENDED)
# =============================================================================

# Required: Your Infisical project ID
INFISICAL_PROJECT_ID=d01f583a-d833-4375-b359-c702a726ac4d

# Required: Your Infisical server URL  
INFISICAL_SERVER_URL=https://secrets.jefahnierocks.com

# Organization information
INFISICAL_ORG_ID=fd347373-e19c-49d1-baf4-7577c245555a
INFISICAL_ORG_SLUG=admin-org-v-ybx

# Universal Auth credentials (PREFERRED - secure, short-lived tokens)
# Runtime identity: token-service@journal
UA_CLIENT_ID_TOKEN_SERVICE=your-ua-client-id-here
UA_CLIENT_SECRET_TOKEN_SERVICE=your-ua-client-secret-here

# Rotator identity: rotator@ops (for key rotation operations)
UA_CLIENT_ID_ROTATOR=your-rotator-client-id-here
UA_CLIENT_SECRET_ROTATOR=your-rotator-client-secret-here

# Environment name in Infisical (dev, staging, prod)
INFISICAL_ENVIRONMENT=prod

# Optional: Cache TTL in seconds (default: 300 = 5 minutes)
INFISICAL_CACHE_TTL=300

# Optional: CLI timeout in seconds (default: 30)
INFISICAL_TIMEOUT=30.0

# Optional: Maximum retry attempts (default: 3)
INFISICAL_MAX_RETRIES=3

# Optional: Webhook HMAC secret for secret change notifications
INFISICAL_WEBHOOK_SECRET=your-webhook-secret-here

# DEPRECATED: Static service token (fallback only)
# INFISICAL_TOKEN=your-static-token-here

# =============================================================================
# TRUSTED PROXY CONFIGURATION (for IP extraction)
# =============================================================================

# Enable proxy header processing (true/false)
ENABLE_PROXY_HEADERS=false

# Comma-separated list of trusted proxy IPs/CIDRs
# Examples: 10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
TRUSTED_PROXIES=

# =============================================================================
# WEBAUTHN/PASSKEYS CONFIGURATION
# =============================================================================

# Relying Party ID (your domain without port)
JOURNAL_WEBAUTHN_RP_ID=localhost

# Display name for your application
JOURNAL_WEBAUTHN_RP_NAME="Journal App"

# Expected origin for WebAuthn verification
JOURNAL_WEBAUTHN_ORIGIN=http://localhost:3000

# =============================================================================
# DEVELOPMENT/TESTING SETTINGS
# =============================================================================

# Set to "true" to enable testing mode (disables certain features)
JOURNAL_TESTING=false

# Set to "1" to disable startup tasks (useful for CI/CD)
JOURNAL_DISABLE_STARTUP=0

# Demo user password (leave empty for production)
JOURNAL_DEMO_PASSWORD=

# =============================================================================
# OPENAI CONFIGURATION (for embeddings)
# =============================================================================

# OpenAI API key for embeddings (optional)
OPENAI_API_KEY=your-openai-api-key-here

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================

# Log level (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# Enable telemetry collection (true/false)
ENABLE_TELEMETRY=true

# Sentry DSN for error tracking (optional)
SENTRY_DSN=

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================

# NATS server URL for event streaming
NATS_URL=nats://localhost:4222

# Email configuration (if using email features)
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USER=your-email@gmail.com
EMAIL_PASSWORD=your-app-password
EMAIL_FROM=noreply@yourjournal.com