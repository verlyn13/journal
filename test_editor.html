<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Tiptap Editor</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="http://127.0.0.1:5000/static/css/tiptap-editor.css">
</head>
<body>
    <div class="container mt-5">
        <h1>Test Tiptap Editor</h1>
        <div class="journal-editor-wrapper">
            <div id="entry-editor"></div>
        </div>
        <textarea id="entry-content" style="display: none;"></textarea>
        
        <div class="mt-3">
            <h3>Output:</h3>
            <pre id="output" class="border p-3"></pre>
        </div>
    </div>

    <script src="http://127.0.0.1:5000/static/dist/tiptap-editor.bundle.js"></script>
    <script>
        console.log('JournalEditor available:', typeof JournalEditor);
        
        document.addEventListener('DOMContentLoaded', () => {
            const editorElement = document.querySelector('#entry-editor');
            const textarea = document.querySelector('#entry-content');
            const output = document.querySelector('#output');
            
            console.log('Elements found:', {editorElement, textarea, output});
            
            if (typeof JournalEditor === 'undefined') {
                console.error('JournalEditor is not defined');
                output.textContent = 'Error: JournalEditor is not defined. Check if the bundle loaded correctly.';
                return;
            }
            
            if (editorElement && textarea) {
                try {
                    console.log('Creating editor instance...');
                    const editor = new JournalEditor(editorElement, {
                        content: '<p>Test content</p>',
                        placeholder: 'Start writing your journal entry...',
                        onUpdate: (content) => {
                            textarea.value = content;
                            output.textContent = content;
                            console.log('Content updated:', content);
                        }
                    });
                    console.log('Editor initialized successfully', editor);
                    
                    // Test if editor is working
                    setTimeout(() => {
                        if (editor.isReady && editor.isReady()) {
                            console.log('Editor is ready and working');
                        } else {
                            console.log('Editor may not be fully initialized');
                        }
                    }, 1000);
                } catch (error) {
                    console.error('Error initializing editor:', error);
                    output.textContent = 'Error: ' + error.message + '\n\nStack: ' + error.stack;
                }
            } else {
                console.error('Editor element not found');
                output.textContent = 'Editor element not found';
            }
        });
    </script>
</body>
</html>